#!/usr/bin/env bash

AIRPORT_INFO=( $(airport -I | grep -E "^ *(agrCtlRSSI|SSID):" | awk '{print $2}') )
RSSI=$(echo "${AIRPORT_INFO[0]}" | sed 's/-//g')
SSID=$(echo "${AIRPORT_INFO[1]}")

if [[ $RSSI -lt 25 ]]; then
  echo -n "#[fg=${thm_red}]"
elif [[ $RSSI -lt 35 ]]; then
  echo -n "#[fg=${thm_orange}]"
elif [[ $RSSI -lt 45 ]]; then
  echo -n "#[fg=${thm_yellow}]"
else
  echo -n "#[fg=${thm_green}]"
fi

if [ -n "$AIRPORT_INFO" ]; then
  [[ -n $SSID ]] && echo -n " $SSID"
  echo -n " -["$RSSI"]db#[default]"
else
  ping -c 1 8.8.8.8 &> /dev/null && echo -n " #[fg=colour148]LAN#[default]" \
    || echo -n ""
fi

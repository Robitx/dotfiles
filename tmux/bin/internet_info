#!/usr/bin/env bash

internet_info=$(airport -I | grep agrCtlRSSI | awk '{print $2}' | sed 's/-//g')

if [[ $internet_info -lt 20 ]]; then
  echo -n '#[fg=colour101]'
elif [[ $internet_info -lt 30 ]]; then
  echo -n '#[fg=colour106]'
elif [[ $internet_info -lt 40 ]]; then
  echo -n '#[fg=colour107]'
elif [[ $internet_info -lt 50 ]]; then
  echo -n '#[fg=colour112]'
else
  echo -n '#[fg=colour113]'
fi

if [ -n "$internet_info" ]; then
  ssid=$(airport -I | sed -En 's/^ +SSID: +//p' || '')
  [[ -n $ssid ]] && echo -n " $ssid"
  echo -n " -[$internet_info]db"
else
  ping -c 1 google.com &> /dev/null && echo -n " #[fg=colour148]LAN" \
    || echo -n ""
fi
